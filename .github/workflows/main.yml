name: CI/CD Pipeline

on:
  push:
    branches:
      - main  # Cambia 'main' al nombre de tu rama principal si es diferente

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout código fuente
      uses: actions/checkout@v2

    - name: Obtener la versión de Java del POM
      id: java-version
      run: |
        echo "::set-output name=java_version::$(xmllint --xpath '/*[local-name()="project"]/*[local-name()="properties"]/*[local-name()="maven.compiler.source"]/text()' pom.xml)"
      shell: bash

    - name: Configurar JDK
      uses: actions/setup-java@v2
      with:
        java-version: ${{ steps.java-version.outputs.java_version }}  # Utiliza la versión del POM

    - name: Ejecutar pruebas Maven
      run: mvn test
